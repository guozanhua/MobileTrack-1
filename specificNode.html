<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <title>Data Analysis Graph</title>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" >
        <link rel="stylesheet" type="text/css" href="css/styles.css" >
        <link rel="stylesheet" type="text/css" href="css/magnific-popup.css" >
        <link rel="stylesheet" type="text/css" href="css/graph.css" >
        <link rel="stylesheet" type="text/css" href="css/bar.css" >
        <link rel="stylesheet" type="text/css" href="css/table2.css" >
    </head>
    <body>


        <div id="doc" class="yui-t1">
            <div id="hd">
                <div id="header"><h1><img src="picture/mahidolbanner.png" alt="this is logo" style="width:100%"></h1></div>
            </div>

       <div id='cssmenu'>
              <ul>
                  <li><a href="select.html"><span>Multiple Phone</span></a></li>
                  
                  
                       <li class='has-sub'><a href='#'><span>Find the middle-man</span></a>
                          <ul>
                             <li class='has-sub'><a href="destination2.html"><span>S--X--D</span></a>
                                
                             </li>
                             <li class='has-sub'><a href="destination3.html"><span>S--X--X--D</span></a>
                                
                             </li> <li class='has-sub'><a href="destination4.html"><span>S--X--X--X--D</span></a>
                                
                             </li>
                             
                          </ul>
                       </li>
                       <li><a href="destination.html"><span>Phone - Phone</span></a></li>
                       <li class='active'><a href="specificNode.html"><span>Specific Number</span></a></li>
                        <li><a href="mainmenu.html"><span>Main Menu</span></a></li>
                </ul>
            </div>

            <div class="yui-b">
                <div id="input">
                    <br/>
                    <p align = "center"><label><font face="supermarket" class="font1" size="2" color="white">- ENTER -</label></p></font>
                    <p align = "center"><label><font face="supermarket" class="font2" size="4"color="white">A PHONENUMBER TO DISPLAY DETAILS OF THE PHONE</label></p></font>

                    <div class="wrapper-dropdown-5">


                        <form id="phonenumber" >

                            <u><p align = "center"><label><font face="supermarket" class="font" size="4">Phone Number</label></p></font></u>
                            <p align = "center"><input type="text"align = "center" class="wrapper-dropdown-6" id="phoneNo"maxlength="10"></input></p>
                        </form>

                        <p align = "center"><button id="submitBtn" class="color green button"  onclick="querySpecificNode($('#phoneNo').val())">Submit</button></p>
                    </div>

                    <p align = "center"><button id="suggestBtn"class="color red button" >Suggest Phone Number</button></p>

                    <div>

                    </div>

                    <br>
                    <div>
                        <u><label><font face="supermarket" class="font" size="4"color="white">Communication Type :</font></label></u>
                        <select id= "spinnerbox" class="wrapper-dropdown-3"name="communicationList" onchange="doSomething();">
                            <option value="select">SELECT</option>
                            <option value="call">CALL</option>
                            <option value="message">MESSAGE</option>
                            <option value="line">LINE</option>
                            <option value="whatapp">WHATAPP</option>
                            <option value="facebook">FACEBOOK</option>

                        </select>
                    </div>
                    <br/>

                    <div>
                        <form id="typeboxcall" style="display:none">
                            <u><label><font face="supermarket"size="4"color="white" class="font" >Type :</font></label></u>
                            <select id="typecall" class="wrapper-dropdown-3">
                                <option value="all">All</option>
                                <option value="incoming">INCOMING</option>
                                <option value="outgoing">OUTGOING</option>
                                <option value="missed">MISSED</option>
                            </select>
                        </form>
                    </div>

                    <div>
                        <form id="typeboxmessage" style="display:none">
                            <u><label><font face="supermarket"size="4"color="white"class="font"  >Type :</font></label></u>
                            <select id="typesms"class="wrapper-dropdown-3" >
                                <option value="all">ALL</option>
                                <option value="send">SEND</option>
                                <option value="received">RECEIVED</option>

                            </select>
                        </form>
                    </div>
                    <br/>
                    <br/>

                    <div  >
                        <form id="date_form" action="demo_form.asp" style="display:none">
                            <div><class="wrapper-dropdown-5">

                                    <u><label><font face="supermarket" size="4"color="white"class="font" >Date from :</font></label></u>
                                    <input id="datefrom" class="wrapper-dropdown-2"type="date" name="bday"><br>
                                    <u><label><font face="supermarket" size="4" color="white"class="font" >To :</font></label></u>
                                    <input id="dateto" class="wrapper-dropdown-2"type="date" name="bday"><br>
                                    </div>

                                    </form>
                                    </div>
                                    <br/>
                                    <br/>
                                   
                                    
                                <div>
                                 <form id="durationbox" style="display:none">
                                         <u><label><font face="supermarket"class="font" size="4" color="white"  >Duration :</font></label ></u>
                                             <br>
                                         <form id="selecttype"> 
                                        <font face="supermarket" size="4" class="font"color="white"><input type="radio" value="ddd" name="read" id="ddd" onchange="specificduration2()">Default Duration</font>
                                            <br>
                                         <font face="supermarket" size="4" class="font"color="white"><input type="radio" value="sdd" name="read" id="sdd" onchange="specificduration()">Specific Duration</font>

                                         </form>
                                  </form>
                                </div>
                                    
                                 <div >
                                 <form id="durationrange"class="wrapper-dropdown-5" style="display:none">
                                         <p align = "center"><label><font face="supermarket"class="font" size="4" color="white"  >Duration range</font></label ></p>
                                           <p align = "center">
                                         <form id="inputduration"> 
                                            <input type="text"align = "center" class="wrapper-dropdown-7" id="fmin" maxlength="5"></input>
                                        <font face="supermarket" size="4" class="font"color="white">mins-</font>
                                            
                                          <input type="text"align = "center" class="wrapper-dropdown-7" id="smin" maxlength="5"></input>
                                        <font face="supermarket" size="4" class="font"color="white">mins</font>

                                         </form>
                                           </p>
                                  
                                </div>
                                    
                                    
                                    
                                <div>
                                 <form id="frequency" style="display:none">
                                         <u><label><font face="supermarket"class="font" size="4" color="white"  >Frequency :</font></label ></u>
                                             <br>
                                         <form id="selecttype"> 
                                        <font face="supermarket" size="4" class="font"color="white"><input type="radio" value="ddf" name="read" id="ddf" onchange="specificfrequency2()" >Default Frequency</font>
                                            <br>
                                         <font face="supermarket" size="4" class="font"color="white"><input type="radio" value="sdf" name="read" id="sdf" onchange="specificfrequency()">Specific Frequency</font>

                                         </form>
                                  </form>
                                </div>
                                    
                                <div  >
                                 <form id="frequencyoperator" class="wrapper-dropdown-5"style="display:none">
                                         <p align = "center"><label><font face="supermarket"class="font" size="4" color="white"  >Operator :</font></label >
                                          
                                         <form id="operatortype"> 
                                        <font face="supermarket" size="4" class="font"color="white"><input type="radio" value="moreequ" name="read" id="moreequ" >>=</font>
                                           
                                         <font face="supermarket" size="4" class="font"color="white"><input type="radio" value="thanequ" name="read" id="thanequ"><=</font>

                                         
                                         </p>
                                  
                                
                                    
                                
                                
                                         <p align = "center"><label><font face="supermarket"class="font" size="4" color="white"  >Frequency :</font></label >
                                             
                                          <input type="text"align = "center" class="wrapper-dropdown-7" id="fof" maxlength="5"></input>
                                      
                                       </p>    

                                 </form>
                                  
                                </div>
<!--                                    <div>
                                        <form id="durationbox" style="display:none">
                                            <u><label><font face="supermarket" size="4"color="white"class="font" >Duration :</font></label ></u>
                                            <select id="duration" class="wrapper-dropdown-3">
                                                <option value="01">0-1 MINUTE</option>
                                                <option value="12">1-2 MINUTE</option>
                                                <option value="23">2-3 MINUTE</option>
                                                 <option value="34">3-4 MINUTE</option>
                                                <option value="45">4-5 MINUTE</option>
                                                <option value="5">MORE 5 MINUTE</option> 
                                            </select>
                                        </form>
                                    </div>-->

                                    <div>
                                        <form id="statusSMS" style="display:none">
                                            <u><label><font face="supermarket" size="4"color="white"class="font" >Status :</font></label ></u>
                                            <select id="status" class="wrapper-dropdown-3">
                                                <option value="all">ALL STATUS</option>
                                                <option value="read">READ</option>
                                                <option value="unread">UNREAD</option>
                                                <!-- <option value="34">3-4 MINUTE</option>
                                                <option value="45">4-5 MINUTE</option>
                                                <option value="5">MORE 5 MINUTE</option> -->
                                            </select>
                                        </form>
                                    </div>
                                    <br>
<!--                                    <div>
                                        <form id="frequency" style="display:none">
                                            <u><label><font face="supermarket" size="4"color="white"class="font" >Frequency :</font></label ></u>
                                            <select id="status" class="wrapper-dropdown-3">
                                                <option value="all">ALL</option>
                                                <option value="3">3</option>
                                                <option value="6">6</option>
                                                <option value="6">9</option>

                                            </select>
                                        </form>
                                    </div>-->

                                    <br/>
                                    <div>
                                        <!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button type="button" onclick="FetchDatabase($('#phoneNo').val())">Send</button> -->
                                        <p align = "right"><button type="button" class="color blue button"onclick="getdata();"size="2" >Send</button></p>


                                    </div>

                                    <div>
                                        <p id="printout"></p>
                                        <p id="printout2"></p>
                                        <p id="printout3"></p>
                                        <p id="printout4"></p>
                                    </div>



                            </div>  
                    </div>

                    <div class="yui-a">
                        <div id="graph">

                        </div>
                    </div>

                    <div class="yui-c">
                        <div id="scollbar" >
                            <font face="supermarket" size="2" color="white">
                                <div id = "displayNode"style="float: left; width: 33%;"></div>
                                <div id = "displayType" style="float: left; width: 33%;"></div>
                                <div id = "displayLink" style="float: left; width: 33%;"></div>
                        </div>

                        <br/>
                        <div id="summarize" >
                            <font face="supermarket" size="2" color="white">

                        </div>
                        <div id="output"></div>
                    </div>

                </div>

            </div>

            <script src='js/d3.v3.min.js'></script>
            <script src="js/d3.tip.js"></script>
            <script type="text/javascript" src="js/specificNodeDetail.js"></script>
            <script type="text/javascript" src="js/specificPhoneDetail.js"></script>
            <script type="text/javascript" src="js/specificSMSDetail.js"></script>
            <script type="text/javascript" src="js/specificFacebookDetail.js"></script>
            <script type="text/javascript" src="js/specificLineCommunication.js"></script>
            <script type="text/javascript" src="js/specificWhatsappCommunication.js"></script>
            <script type="text/javascript" src="js/BuildQuery.js"></script>
            <script type="text/javascript" src="js/jquery.min.js"></script>
            <script type="text/javascript" src="js/jquery.magnific-popup.js"></script>
            <script type="text/javascript" src="js/helperfunction.js"></script>

            <script>
                                            function doSomething() {
                                                var a = document.getElementById("spinnerbox").value;

                                                document.getElementById("date_form").style.display = "none";
                                                document.getElementById("durationbox").style.display = "none"
                                                document.getElementById("typeboxcall").style.display = "none";
                                                document.getElementById("typeboxmessage").style.display = "none";
                                                document.getElementById("statusSMS").style.display = "none";
                                                document.getElementById("frequency").style.display = "none";
                                                document.getElementById("durationrange").style.display = "none";
                                                 document.getElementById("frequencyoperator").style.display = "none";
                                                console.log(a);

                                                if (a == "call") {
                                                    document.getElementById("date_form").style.display = "block";

                                                    document.getElementById("durationbox").style.display = "block";
                                                    document.getElementById("typeboxcall").style.display = "block";
                                                    document.getElementById("frequency").style.display = "block";
                                                }
                                                else if (a == "message") {
                                                    document.getElementById("date_form").style.display = "block";

                                                    document.getElementById("typeboxmessage").style.display = "block";
                                                    document.getElementById("statusSMS").style.display = "block";
                                                    document.getElementById("frequency").style.display = "block";
                                                }
                                                else if (a == "line") {
                                                    document.getElementById("date_form").style.display = "block";
                                                    document.getElementById("frequency").style.display = "block";


                                                }
                                                else if (a == "facebook") {
                                                    document.getElementById("date_form").style.display = "block";
                                                    document.getElementById("frequency").style.display = "block";


                                                }
                                                else if (a == "whatapp") {
                                                    document.getElementById("date_form").style.display = "block";
                                                    document.getElementById("frequency").style.display = "block";


                                                }
                                                else {
                                                    /*document.getElementById("date_form").style.display="none";
                                                     document.getElementById("phonenumber").style.display="none";
                                                     document.getElementById("durationbox").style.display="none"
                                                     document.getElementById("typeboxcall").style.display="none";
                                                     document.getElementById("typeboxmessage").style.display="none";
                                                     document.getElementById("status").style.display="none";*/
                                                }
                                            }
            </script>
            
             <script>


        function specificduration() {
            var a = document.getElementById("sdd").value;
                document.getElementById("durationrange").style.display = "none";
            if (a == "sdd") {
                document.getElementById("durationrange").style.display = "block";
            }
            
        }
        
         function specificduration2() {
            var a = document.getElementById("ddd").value;
                document.getElementById("durationrange").style.display = "none";
           
            
        }
    </script>
    <script>
        function specificfrequency() {
            var a = document.getElementById("sdf").value;
           
            if (a == "sdf") {
                document.getElementById("frequencyoperator").style.display = "block";
               
                //document.getElementById("typeboxcall").style.display="block";
            }

            writecheck();

        }
        
           function specificfrequency2() {
            var a = document.getElementById("ddf").value;
           document.getElementById("frequencyoperator").style.display = "none";
            
            writecheck();

        }
    </script>
            
            
            <script>
                function getdata() {
                    var communicationType;
                    var call = 0;
                    var dur = 0;
                    var a = document.getElementById("spinnerbox").value;

                    if (a == "call") {
                        communicationType = 1;
                        var e = document.getElementById("typecall").value;
                        var dateFrom = document.getElementById("datefrom").value;
                        var dateTo = document.getElementById("dateto").value;
                        var d = document.getElementById("duration").value;
                        console.log(d);
                        if (e == "all") {
                            call = 1;
                            if (d == "01") {
                                dur = 1;
                            } else if (d == "12") {
                                dur = 2;
                            } else if (d == "23") {
                                dur = 3;
                            }
                        }
                        else if (e == "incoming") {
                            call = 2;
                            if (d == "01") {
                                dur = 1;
                            } else if (d == "12") {
                                dur = 2;
                            } else if (d == "23") {
                                dur = 3;
                            }
                        }
                        else if (e == "outgoing") {
                            call = 3;
                            if (d == "01") {
                                dur = 1;
                            } else if (d == "12") {
                                dur = 2;
                            } else if (d == "23") {
                                dur = 3;
                            }
                        }
                        else {
                            call = 4;
                            if (d == "01") {
                                dur = 1;
                            } else if (d == "12") {
                                dur = 2;
                            } else if (d == "23") {
                                dur = 3;
                            }
                        }
                    } else if (a == "message") {
                        communicationType = 2;
                        var t = document.getElementById("typesms").value;
                        var s = document.getElementById("status").value;
                        console.log(s);
                        if (t == "all") {
                            sms = 1;
                            if (s == "read") {
                                stat = 2;
                            } else if (s == "unread") {
                                stat = 3;
                            } else {
                                stat = 1;
                            }
                        } else if (t == "send") {
                            sms = 2;
                            if (s == "read") {
                                stat = 2;
                            } else if (s == "unread") {
                                stat = 3;
                            } else {
                                stat = 1;
                            }
                        } else {
                            sms = 3;
                            if (s == "read") {
                                stat = 2;
                            } else if (s == "unread") {
                                stat = 3;
                            } else {
                                stat = 1;
                            }
                        }
                    } else if (a == "line") {
                        communicationType = 3;
                    } else if (a == "whatapp") {
                        communicationType = 4;
                    } else if (a == "facebook") {
                        communicationType = 5;
                    }


                    if (communicationType == 1) {
                        buildQueryForCall(call, dur);
                    } else if (communicationType == 2) {
                        buildQueryForSMS(sms, stat);
                    }
                    else if (communicationType == 3) {
                        LineDatabase();
                    } else if (communicationType == 4) {
                        WhatsappDatabase();
                    } else if (communicationType == 5) {
                        FacebookDatabase();
                    }
                    else {
                        alert("Please select communication type");
                    }

                }

            </script>

            <script>
                //Load all the possible phone numbers into the list to be ready for display when user hit suggestion button.
                var _queryString = "MATCH (n:PHONE) RETURN n";
                var phoneNumberArr = [];
                var myTable;

                d3.xhr("http://localhost:7474/db/data/transaction/commit")
                        .header("Content-Type", "application/json")
                        .mimeType("application/json")
                        .post(
                                JSON.stringify({
                                    "statements": [{
                                            "statement": _queryString,
                                            "resultDataContents": ["row"]//, "graph" ]
                                        }]
                                }), function (err, data) {
                            var returnData = JSON.parse(data.responseText);
                            //document.write(JSON.stringify(returnData));
                            var result = returnData.results[0].data;
                            //document.write(JSON.stringify(result));
                            for (i = 0; i < result.length; i++) {
                                var objAdd = {};
                                objAdd.PhoneNumber = result[i].row[0].PhoneNumber;
                                objAdd.Owner = result[i].row[0].Owner;
                                objAdd.Model = result[i].row[0].Model;
                                phoneNumberArr.push(objAdd);
                            }
                            //document.write(JSON.stringify(phoneNumberArr));
                            myTable = "<table><tr><th style='background-color:#333333;height: 40px; width:150px; border: 2px solid white; color: white; text-align: center;'>PhoneNumber</th>";
                            myTable += "<th style='background-color:#333333;height: 40px; width:150px; border:2px solid white; color: white; text-align: center;'>Model</th>";
                            myTable += "<th style='background-color:#333333;height: 40px; width:200px; border: 2px solid white; color: white; text-align: center;'>Owner</th>";
                            for (var i = 0; i < phoneNumberArr.length; i++) {
                                myTable += "<tr><td style='height: 40px; text-align: center;background-color:#8B8B83;border: 2px solid white;'>" + phoneNumberArr[i].PhoneNumber + "</td>";
                                myTable += "<td style='height: 40px; text-align: center;background-color:#BEBEBE;border: 2px solid white;'>" + phoneNumberArr[i].Model + "</td>";
                                myTable += "<td style='height: 40px; text-align: center;background-color:#8B8B83;border: 2px solid white;'>" + phoneNumberArr[i].Owner + "</td></tr>";
                            }
                            myTable += "</table>";
                            $('#suggestBtn').magnificPopup({
                                items: {
                                    src: '<div class="white-popup">' +
                                            myTable
                                            + '</div>',
                                    type: 'inline'
                                },
                                closeBtnInside: true
                            });
                        });

            </script>

            
            <script>
                /*Navigation Bar Controller*/
                ;
                (function ($) {
                    "use strict";
                    $(document).ready(function () {
                        $('#access').on('touchstart click', '.skip-link', function (event) {
                            $(this).toggleClass('focus');
                            $($(this).attr('href')).toggleClass('target');
                            event.preventDefault();
                        }).find('.skip-link').append('<span>' + $('#menu .active').text() + '</span>');
                    });
                })(jQuery);
            </script>

    </body>
</html>
