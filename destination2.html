<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Data Analysis Graph</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" >
<link rel="stylesheet" type="text/css" href="css/styles2.css" >
<link rel="stylesheet" type="text/css" href="css/magnific-popup.css" >
<link rel="stylesheet" type="text/css" href="css/graph.css" >
<link rel="stylesheet" type="text/css" href="css/bar.css" >
<link rel="stylesheet" type="text/css" href="css/divpopup.css" >
<link rel="stylesheet" type="text/css" href="css/table.css" >
</head>
<body>
<div id="doc" class="yui-t1">
  <div id="hd">
    <div id="header"><h1><img src="picture/mahidolbanner.png" alt="this is logo" style="width:100%"></h1></div>
  </div>
 <div id='cssmenu'>
              <ul>
                  <li><a href="select.html"><span>Multiple Phone</span></a></li>
                  
                  
                       <li class='has-sub active'><a href='#'><span>Find the middle-man</span></a>
                          <ul>
                             <li class='has-sub'><a href="destination2.html"><span>S--X--D</span></a>
                                
                             </li>
                             <li class='has-sub'><a href="destination3.html"><span>S--X--X--D</span></a>
                                
                             </li> <li class='has-sub'><a href="destination4.html"><span>S--X--X--X--D</span></a>
                                
                             </li>
                             
                          </ul>
                       </li>
                       <li><a href="destination.html"><span>Phone - Phone</span></a></li>
                       <li><a href="specificNode.html"><span>Specific Number</span></a></li>
                        <li><a href="mainmenu.html"><span>Main Menu</span></a></li>
                </ul>
            </div>
    <div class="yui-b">
      <div id="input">
         
        <br/>
       <p align = "center"><label><font face="supermarket" class="font1" size="2" color="white">- ENTER -</label></p></font>
        <p align = "center"><label><font face="supermarket" class="font2" size="4"color="white">SOURCE AND TARGET NUMBERS TO DISPLAY THE COMMUNICATION</label></p></font>
           <div class="wrapper-dropdown-5">

          <form id="phonenumber" >
            <u><p align = "center"><label><font face="supermarket" class="font" size="4">Source Phone Number</font></label></u>
            <input type="text" id="sourcePhoneNo"class="wrapper-dropdown-6"maxlength="10"></input>
            <br></br>
            <u><label><font face="supermarket" class="font" size="4">Target Phone Number</font></label></u>
           <input type="text" id="targetPhoneNo"class="wrapper-dropdown-6"maxlength="10"></input>
          </form>
        </div>  

         <p align = "center"><button id="suggestBtn"class="color red button" >Suggest Phone Number</button></p>
       
        <br>   
        <div>
          <form id="status" >
          <u><label><font face="supermarket"class="font"size="4"color="white" >Route Communication :</font></label><br></u>
            <font face="supermarket"class="font" size="4" color="white"><input type="radio" id="sxdrad1" name="call" value="" >S--->X--->D</font>
             <br>  
            <font face="supermarket"class="font"size="4" color="white"><input type="radio" id="sxdrad2" name="call" value="" >S--->X<---D</font>
             <br>
            <font face="supermarket" class="font"size="4" color="white"><input type="radio" id="sxdrad3" name="call" value="" >S<---X--->D</font>
             <br>
            <font face="supermarket"class="font" size="4" color="white"><input type="radio" id="sxdrad4" name="call" value="" >S<---X<---D</font>
             <br> 

          </form>
        </div>
        <br> 
        <div>
          <form id="status" >
           
          <u><label><font face="supermarket"class="font"size="4"color="white" >Type Communication :</font></label><br></u>  
             <font face="supermarket" class="font"size="4" color="white"><input type="checkbox" id="sxdchk1" name="call" value="" >CALL</font>
             <br>  
             <font face="supermarket" class="font"size="4" color="white"><input type="checkbox" id="sxdchk2" name="sms" value="">SMS</font>
             <br>  
             <font face="supermarket" class="font"size="4" color="white"><input type="checkbox" id="sxdchk3" name="line" value="">LINE</font>
             <br>  
             <font face="supermarket" class="font"size="4" color="white"><input type="checkbox" id="sxdchk4" name="facbook" value="">WHATSAPP</font>
             <br>  
             <font face="supermarket" class="font"size="4" color="white"><input type="checkbox" id="sxdchk5" name="whatapp" value="">FACEBOOK</font>
          </form>

    
        </div>
        <br>
         <div  >
          <form id="date_form" action="demo_form.asp" >
          <div><class="wrapper-dropdown-5">
                   
            <u><label><font face="supermarket" size="4"color="white"class="font" >Date from :</font></label></u>
            <input id="datefrom" class="wrapper-dropdown-2"type="date" name="bday"><br>
            <u><label><font face="supermarket" size="4" color="white"class="font" >To :</font></label></u>
            <input id="dateto" class="wrapper-dropdown-2"type="date" name="bday"><br>
            </div>

          </form>
        </div>
        <br>
         
          <div>
          <!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button type="button" onclick="FetchDatabase($('#phoneNo').val())">Send</button> -->
           <p align = "right"><button type="button" class="color blue button" onclick="actionPerformed();"size="2">Send</button></p>
        </div>
    
      
      </div>  
    </div>




    <div class="yui-a">
      <div id="graph">
        
      </div>
        
        <div id="blanket" style="display:none"></div>
                <div id="progressDiv" style="display:none">
                    <p id="progressDisplay" ></p>
                </div>
    </div>

    <div class="yui-c">
      <div id="scollbar" >
        <font face="supermarket" size="2" color="white">
        <div id = "displayNode"style="float: left; width: 33%;"></div>
        <div id = "displayType" style="float: left; width: 33%;"></div>
        <div id = "displayLink" style="float: left; width: 33%;"></div>
      </div>

      <br/>
      <div id="summarize" >
        <font face="supermarket" size="2" color="white">
        
      </div>
      <div id="output"></div>
    </div>
    </div>
    
  </div>

</div>

<script src="js/d3.v3.min.js"></script>
<script src="js/d3.tip.js"></script>
<script type="text/javascript" src="js/specificNodeDetail.js"></script>
<script type="text/javascript" src="js/BuildQuery.js"></script>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.magnific-popup.js"></script>
<script type="text/javascript" src="js/helperfunction.js"></script>
<script type="text/javascript" src="js/intermediaryNodeQuery.js"></script>
<script type="text/javascript" src="js/divpopuphandler.js"></script>

<script type="text/javascript">
function actionPerformed(){
  var linkType = [];
  if(document.getElementById("sxdrad1").checked){
    var selections = [];
    if(document.getElementById("sxdchk3").checked){
      var objCommu = {};
      objCommu.Type = 'Line';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk4").checked){
      var objCommu = {};
      objCommu.Type = 'Whatsapp';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk5").checked){
      var objCommu = {};
      objCommu.Type = 'Facebook';
      selections.push(objCommu);
    }

    if(document.getElementById("sxdchk2").checked){
      var objCommu = {};
      objCommu.Type = 'SMS';
      objCommu.linkType = ['-[r1:SMS]->','-[r2:SMS]->'];
      selections.push(objCommu);

    }

    if(document.getElementById("sxdchk1").checked){
      var objCommu = {};
      objCommu.Type = 'Call';
      objCommu.linkType = ['-[r1:Call]->','-[r2:Call]->'];
      selections.push(objCommu);

    }
    if(selections.length > 0){
      console.log(selections.length);
      queryManagementSXD(selections);
    }

  }else if(document.getElementById("sxdrad2").checked){
    var selections = [];
    if(document.getElementById("sxdchk3").checked){
      var objCommu = {};
      objCommu.Type = 'Line';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk4").checked){
      var objCommu = {};
      objCommu.Type = 'Whatsapp';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk5").checked){
      var objCommu = {};
      objCommu.Type = 'Facebook';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk2").checked){
      var objCommu = {};
      objCommu.Type = 'SMS';
      objCommu.linkType = ['-[r1:SMS]->','<-[r2:SMS]-'];
      selections.push(objCommu);

    }if(document.getElementById("sxdchk1").checked){
      var objCommu = {};
      objCommu.Type = 'Call';
      objCommu.linkType = ['-[r1:Call]->','<-[r2:Call]-'];
      selections.push(objCommu);

    }
    //Check if there is any communication in selections
    if(selections.length > 0){
      console.log(selections.length);
      queryManagementSXD(selections);
    }
  }else if(document.getElementById("sxdrad3").checked){
    var selections = [];
    if(document.getElementById("sxdchk3").checked){
      var objCommu = {};
      objCommu.Type = 'Line';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk4").checked){
      var objCommu = {};
      objCommu.Type = 'Whatsapp';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk5").checked){
      var objCommu = {};
      objCommu.Type = 'Facebook';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk2").checked){
      var objCommu = {};
      objCommu.Type = 'SMS';
      objCommu.linkType = ['<-[r1:SMS]-','-[r2:SMS]->'];
      selections.push(objCommu);

    }
    if(document.getElementById("sxdchk1").checked){
      var objCommu = {};
      objCommu.Type = 'Call';
      objCommu.linkType = ['<-[r1:Call]-','-[r2:Call]->'];
      selections.push(objCommu);

    }
    //Check if there is any communication in selections
    if(selections.length > 0){
      console.log(selections.length);
      queryManagementSXD(selections);
    }

  }else if(document.getElementById("sxdrad4").checked){
    var selections = [];
    if(document.getElementById("sxdchk3").checked){
      var objCommu = {};
      objCommu.Type = 'Line';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk4").checked){
      var objCommu = {};
      objCommu.Type = 'Whatsapp';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk5").checked){
      var objCommu = {};
      objCommu.Type = 'Facebook';
      selections.push(objCommu);

    }if(document.getElementById("sxdchk2").checked){
      var objCommu = {};
      objCommu.Type = 'SMS';
      objCommu.linkType = ['<-[r1:SMS]-','<-[r2:SMS]-'];
      selections.push(objCommu);

    }if(document.getElementById("sxdchk1").checked){
      var objCommu = {};
      objCommu.Type = 'Call';
      objCommu.linkType = ['<-[r1:Call]-','<-[r2:Call]-'];
      selections.push(objCommu);

    }
    //Check if there is any communication in selections
    if(selections.length > 0){
      console.log(selections.length);
      queryManagementSXD(selections);
    }
  }
  else{
    alert("Please select communication route !")
  }
}

</script>

<script>
//Load all the possible phone numbers into the list to be ready for display when user hit suggestion button.
var _queryString = "MATCH (n:PHONE) RETURN n";
var phoneNumberArr = [];
var myTable;

d3.xhr("http://localhost:7474/db/data/transaction/commit")
          .header("Content-Type", "application/json")
          .mimeType("application/json")       
          .post(
              JSON.stringify({
            "statements" : [ {
              "statement" : _queryString,
              "resultDataContents" : [ "row" ]//, "graph" ]
            } ]
          }),function(err, data){
                var returnData = JSON.parse(data.responseText);
                //document.write(JSON.stringify(returnData));
                var result = returnData.results[0].data;
                //document.write(JSON.stringify(result));
                for(i=0;i<result.length;i++){
                  var objAdd = {};
                  objAdd.PhoneNumber = result[i].row[0].PhoneNumber;
                  objAdd.Owner = result[i].row[0].Owner;
                  objAdd.Model = result[i].row[0].Model;
                  phoneNumberArr.push(objAdd);
                }
                //document.write(JSON.stringify(phoneNumberArr));
                myTable = "<table><tr><th class='styleheadtable1'>PhoneNumber";
                            myTable += "<th class='styleheadtable1'>Model</th>";
                            myTable += "<th class='styleheadtable1'>Owner</th>";
                            for (var i = 0; i < phoneNumberArr.length; i++) {
                                myTable += "<tr class='styletable1'><td class='stylerowtable1'>" + phoneNumberArr[i].PhoneNumber + "</td>";
                                myTable += "<td class='stylerowtable1'>" + phoneNumberArr[i].Model + "</td>";
                                myTable += "<td class='stylerowtable1'>" + phoneNumberArr[i].Owner + "</td></tr>";
                            }
                myTable+="</table>";
                $('#suggestBtn').magnificPopup({
                  items: {
                      src: '<div class="white-popup">'+
                      myTable
                      +'</div>',
                      type: 'inline'
                  },
                  closeBtnInside: true
                });
});

</script>

</body>
</html>
            
          
