<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Data Analysis Graph</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" >
<link rel="stylesheet" type="text/css" href="css/selectcss.css" >
<link rel="stylesheet" type="text/css" href="css/magnific-popup.css" >
<link rel="stylesheet" type="text/css" href="css/graph.css" >

</head>
<body>
<div id="doc" class="yui-t1">
  <div id="hd">
    <div id="header"><h1><img src="picture/mahidolbanner.png" alt="this is logo" style="width:1680px;height:155px"></h1></div>
  </div>
 
    <div class="yui-b">
      <div id="input">
        <br> 
        <br> 
         <div>
        
         <label><font face="supermarket" size="4" color="white" >PLEASE SELECT AN OPTION</font></label >
              <br>
         <form id="selecttype"> 
             <font face="supermarket" size="4" color="white"><input type="radio" value="ap" name="read" id="ap" onchange="allNumbers()">ALL PHONENUMBER</font>
              <br>
             <font face="supermarket" size="4" color="white"><input type="radio" value="mp" name="read" id="mp" onchange="mainNumbers()">MAIN PHONENUMBER</font>
           
        </form>
        </div>
       <br>
        <div>
        <label><font face="supermarket"size="4"color="white" id="la"style="display:none">SELECT PHONENUMBER</font></label> 
        </div>
        <div id="checkboxbar" style="display:none">
          <font face="supermarket" size="4" color="white">
          <div name="checkboxes" id="box"></div>
        </font>

    
        </div>
          <br>
          <form id="status" style = "display:none" > 
          <label><font face="supermarket"size="4"color="white" >Select Type of Communication</font></label><br>  
             <font face="supermarket" size="4" color="white"><input type="checkbox" name="call" id = "mchk1" value="" >CALL</font>
             <br>  
             <font face="supermarket" size="4" color="white"><input type="checkbox" name="sms" id = "mchk2" value="">SMS</font>
             <br>  
             <font face="supermarket" size="4" color="white"><input type="checkbox" name="line" id = "mchk3" value="">LINE</font>
             <br>  
             <font face="supermarket" size="4" color="white"><input type="checkbox" name="facbook" id = "mchk4" value="">WHATSAPP</font>
             <br>  
             <font face="supermarket" size="4" color="white"><input type="checkbox" name="whatapp" id = "mchk5" value="">FACEBOOK</font>
          </form>


        <br>
         <div>
          <form id="spinnerboxForm" style = "display:none" >
            <label><font face="supermarket" size="4"color="white">CONMUNICATION TYPE:</font></label>
            <select id= "spinnerbox"class="wrapper-dropdown-3" name="communicationList"onchange="doSomething();">
                    <option value="select">SELECT</option>
                     <option value="call">CALL</option>
                     <option value="message">MESSAGE</option>
                     <option value="line">LINE</option>
                     <option value="whatsapp">WHATSAPP</option>
                     <option value="facebook">FACEBOOK</option>
            </select>
          </form>
        </div>
          <br/>
         
        <div>
          <form id="typeboxcall" style="display:none">
          <label><font face="supermarket"size="4"color="white" >TYPE:</font></label>
          <select id="typecall" class="wrapper-dropdown-3">
                    <option value="all">All</option>
                    <option value="incoming">INCOMING</option>
                    <option value="outgoing">OUTGOING</option>
                    <option value="missed">MISSED</option>
          </select>
          </form>
        </div>

        <div>
          <form id="typeboxmessage" style="display:none">
          <label><font face="supermarket"size="4"color="white" >TYPE:</font></label>
          <select id="typesms"class="wrapper-dropdown-3" >
                    <option value="all">ALL</option>
                    <option value="send">SEND</option>
                    <option value="received">RECEIVED</option>
                    
          </select>
          </form>
        </div>
        <br/><br/>

        <div>
          <form id="date_form" action="demo_form.asp" style="display:none">
            <label><font face="supermarket" size="4"color="white">DATE FROM:</font></label>
            <input id="datefrom" class="wrapper-dropdown-2"type="date" name="bday"><br>
            <label><font face="supermarket" size="4" color="white">TO:</font></label>
            <input id="dateto" class="wrapper-dropdown-2"type="date" name="bday"><br>
          </form>
        </div>
         <br/><br/>
        <div>
          <form id="durationbox" style="display:none">
          <label><font face="supermarket" size="4"color="white">DURATION:</font></label >
          <select id="duration" class="wrapper-dropdown-3">
                    <option value="01">0-1 MINUTE</option>
                     <option value="12">1-2 MINUTE</option>
                     <option value="23">2-3 MINUTE</option>
                     <!-- <option value="34">3-4 MINUTE</option>
                     <option value="45">4-5 MINUTE</option>
                     <option value="5">MORE 5 MINUTE</option> -->
          </select>
          </form>
        </div>

        <div>
          <form id="statusSMS" style="display:none">
          <label><font face="supermarket" size="4"color="white">STATUS:</font></label >
          <select id="status" class="wrapper-dropdown-3">
                    <option value="all">ALL STATUS</option>
                     <option value="read">READ</option>
                     <option value="unread">UNREAD</option>
                     <!-- <option value="34">3-4 MINUTE</option>
                     <option value="45">4-5 MINUTE</option>
                     <option value="5">MORE 5 MINUTE</option> -->
          </select>
        </form>
        </div>
        <div>
          <!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button type="button" onclick="FetchDatabase($('#phoneNo').val())">Send</button> -->
           <p align = "right"><button type="button" class="color blue button"onclick="submitButtonPressed();"size="2">Send</button></p>
        </div>
         
      
      </div>  
    </div>

    <div class="yui-a">
      <div id="graph">
        <div id="res"></div>
        
      </div>
    </div>

    <div class="yui-c">
      <div id="scollbar" >
        <font face="supermarket" size="2" color="white">
        <div id = "displayNode"style="float: left; width: 33%;"></div>
        <div id = "displayType" style="float: left; width: 33%;"></div>
        <div id = "displayLink" style="float: left; width: 33%;"></div>
      </div>
      <br/>
      <div id="output">
      </div>
    </div>
    
  </div>

</div>
<script>
function doSomething(){
  var a = document.getElementById("spinnerbox").value;

    document.getElementById("date_form").style.display="none";
    document.getElementById("durationbox").style.display="none"
    document.getElementById("typeboxcall").style.display="none";
    document.getElementById("typeboxmessage").style.display="none";
    document.getElementById("statusSMS").style.display="none";
    console.log(a);

  if(a=="call"){
    document.getElementById("date_form").style.display="block";
    
    document.getElementById("durationbox").style.display="block";
    document.getElementById("typeboxcall").style.display="block";
    }
  else if (a=="message") {
    document.getElementById("date_form").style.display="block";
    
    document.getElementById("typeboxmessage").style.display="block";
    document.getElementById("statusSMS").style.display="block";
    }
  else if (a=="line") {
    document.getElementById("date_form").style.display="block";
    
   
    }
  else if (a=="facebook") {
    document.getElementById("date_form").style.display="block";
    
   
    }
  else if (a=="whatapp") {
    document.getElementById("date_form").style.display="block";
    
   
    }
  else{
    /*document.getElementById("date_form").style.display="none";
    document.getElementById("phonenumber").style.display="none";
    document.getElementById("durationbox").style.display="none"
    document.getElementById("typeboxcall").style.display="none";
    document.getElementById("typeboxmessage").style.display="none";
    document.getElementById("status").style.display="none";*/
    }
}
</script>

<script>
function allNumbers(){
  var a = document.getElementById("ap").value;
  document.getElementById("la").style.display="none"
  document.getElementById("checkboxbar").style.display="none";
  document.getElementById("status").style.display = "none";
  document.getElementById("spinnerboxForm").style.display = "block";
}
</script>
<script>
function mainNumbers(){
  var a = document.getElementById("mp").value;
  document.getElementById("la").style.display="none"
  document.getElementById("checkboxbar").style.display="none";
  document.getElementById("spinnerboxForm").style.display = "none";

  if(a=="mp"){
    document.getElementById("la").style.display="block";
    document.getElementById("checkboxbar").style.display="block";
    document.getElementById("status").style.display = "block";
    //document.getElementById("typeboxcall").style.display="block";
  }

writecheck();

}
</script>
<script>
function submitButtonPressed(){
  var selections = [];
  
  if(document.getElementById("ap").checked){
    var allPhoneCommuType = document.getElementById("spinnerbox").value;
    if(allPhoneCommuType == 'line'){
      var objCommu = {};
      objCommu.Type = 'Line';
      objCommu.linkType = '-[r1:LINEchat]->';
      selections.push(objCommu);

    }else if(allPhoneCommuType == 'whatsapp'){
      var objCommu = {};
      objCommu.Type = 'Whatsapp';
      objCommu.linkType = '-[r1:WhatsappChat]->';
      selections.push(objCommu);
    }else if(allPhoneCommuType == 'facebook'){
      var objCommu = {};
      objCommu.Type = 'Facebook';
      selections.push(objCommu);
    }else if(allPhoneCommuType == 'call'){
      var objCommu = {};
      objCommu.Type = 'Call';
      selections.push(objCommu);
    }else{
       var objCommu = {};
      objCommu.Type = 'SMS';
      selections.push(objCommu);
    }
    queryAllPhones(selections);
  }else if(document.getElementById("mp").checked){
    if(document.getElementById("mchk3").checked){
        var objCommu = {};
        objCommu.Type = 'Line';
        selections.push(objCommu);
    }if(document.getElementById("mchk4").checked){
        var objCommu = {};
        objCommu.Type = 'Whatsapp';
        selections.push(objCommu);
    }if(document.getElementById("mchk5").checked){
        var objCommu = {};
        objCommu.Type = 'Facebook';
        selections.push(objCommu);
    }if(document.getElementById("mchk1").checked){
        var objCommu = {};
        objCommu.Type = 'Call';
        selections.push(objCommu);
        
    }if(document.getElementById("mchk2").checked){
        var objCommu = {};
        objCommu.Type = 'SMS';
        selections.push(objCommu);
    }
    
    if(selections.length > 0){
      var selectPhoneArr = showchecked();
      queryMultiplePhones(selections,selectPhoneArr);
    }else{
      alert("Please select communication type");
    }
  }else{
    alert("Please select phone number options");
  }

}

function writecheck(){
  var _queryString = "MATCH (n:PHONE) RETURN n";
  var phoneNumberArr = [];
  var myTable;
  var i;
  d3.xhr("http://localhost:7474/db/data/transaction/commit")
          .header("Content-Type", "application/json")
          .mimeType("application/json")       
          .post(
              JSON.stringify({
            "statements" : [ {
              "statement" : _queryString,
              "resultDataContents" : [ "row" ]//, "graph" ]
            } ]
          }),function(err, data){
                var returnData = JSON.parse(data.responseText);
                //document.write(JSON.stringify(returnData));
                var result = returnData.results[0].data;
                //document.write(JSON.stringify(result));
                for(i=0;i<result.length;i++){
                  var objAdd = {};
                  objAdd.PhoneNumber = result[i].row[0].PhoneNumber;
                  phoneNumberArr.push(objAdd);
                  
                }
                checkcreate(phoneNumberArr,result.length);
            });
}

function checkcreate(num,length){
  var checkbox = document.createElement('input');
  var container = document.getElementById("box");
  container.innerHTML = "";

  for(i=0;i<length;i++){
    checkbox.type = "checkbox";
    checkbox.name = "name";
    checkbox.value = num[i].PhoneNumber;
    checkbox.id = i;
    var label = document.createElement('label')
    label.htmlFor = "id";
    label.appendChild(document.createTextNode(num[i].PhoneNumber));

    container.appendChild(checkbox);
    container.appendChild(label);
    container.innerHTML+='<br>';
  }

}

function showchecked(){

  var inputElements = document.getElementsByName('name');
  var i;
  var res = document.getElementById('res');
  var selectPhoneNumber = [];
  for(i=0; i<inputElements.length;i++){
    if(inputElements[i].checked){
      selectPhoneNumber.push(inputElements[i].value);
    }
  }

  return selectPhoneNumber;
}

</script>

<script src='js/d3.v3.min.js'></script>
<script src="js/d3.tip.js"></script>
<script type="text/javascript" src="js/specificNodeDetail.js"></script>
<script type="text/javascript" src="js/BuildQuery.js"></script>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.magnific-popup.js"></script>
<script type="text/javascript" src="js/helperfunction.js"></script>
<script src = 'js/multiplePhoneSelection.js'></script>
<script src = 'js/allPhone.js'></script>

</body>
</html>
            
          